{"version":3,"sources":["TextEditor.js","App.js","index.js"],"names":["TOOLBAR_OPTIONS","header","font","list","color","background","script","align","TextEditor","documentId","useParams","id","useState","socket","setSocket","quill","setQuill","console","log","useEffect","s","io","transports","disconnect","handler","delta","oldDelta","source","emit","on","off","updateContents","once","document","setContents","enable","interval","setInterval","getContents","clearInterval","wrapperRef","useCallback","wrapper","innerHTML","editor","createElement","append","q","Quill","theme","modules","toolbar","disable","setText","className","ref","App","path","exact","to","uuidV4","ReactDOM","render","StrictMode","getElementById"],"mappings":"+OAOMA,EAAkB,CACtB,CAAC,CAAEC,OAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAG,KAC9B,CAAC,CAAEC,KAAM,KACT,CAAC,CAAEC,KAAM,WAAa,CAAEA,KAAM,WAC9B,CAAC,OAAQ,SAAU,aACnB,CAAC,CAAEC,MAAO,IAAM,CAAEC,WAAY,KAC9B,CAAC,CAAEC,OAAQ,OAAS,CAAEA,OAAQ,UAC9B,CAAC,CAAEC,MAAO,KACV,CAAC,QAAS,aAAc,cACxB,CAAC,UAGY,SAASC,IACpB,IAAWC,EAAcC,cAAlBC,GACP,EAA4BC,qBAA5B,mBAAOC,EAAP,KAAeC,EAAf,KACA,EAA0BF,qBAA1B,mBAAOG,EAAP,KAAcC,EAAd,KACAC,QAAQC,IAAIT,GAEZU,qBAAU,WACN,IAAMC,EAAIC,aAAG,wBAAyB,CAAEC,WAAY,CAAC,YAAa,UAAW,iBAG7E,OAFAR,EAAUM,GAEH,WACHA,EAAEG,gBAEP,IAEHJ,qBAAU,WACN,GAAc,MAAVN,GAA2B,MAATE,EAAtB,CAEA,IAAMS,EAAU,SAACC,EAAOC,EAAUC,GACf,SAAXA,GACJd,EAAOe,KAAK,eAAgBH,IAKhC,OAFAV,EAAMc,GAAG,cAAeL,GAEjB,WACHT,EAAMe,IAAI,cAAeN,OAE9B,CAACX,EAAQE,IAEZI,qBAAU,WACN,GAAc,MAAVN,GAA2B,MAATE,EAAtB,CAEA,IAAMS,EAAU,SAACC,GACbV,EAAMgB,eAAeN,IAKzB,OAFAZ,EAAOgB,GAAG,kBAAmBL,GAEtB,WACHX,EAAOiB,IAAI,kBAAmBN,OAEnC,CAACX,EAAQE,IAEZI,qBAAU,WACQ,MAAVN,GAA2B,MAATE,IAEtBF,EAAOmB,KAAK,iBAAiB,SAAAC,GACzBlB,EAAMmB,YAAYD,GAClBlB,EAAMoB,YAGVtB,EAAOe,KAAK,eAAgBnB,MAC7B,CAACI,EAAQE,EAAON,IAEnBU,qBAAU,WACN,GAAc,MAAVN,GAA2B,MAATE,EAAtB,CAEA,IAAMqB,EAAWC,aAAY,WACzBxB,EAAOe,KAAK,gBAAiBb,EAAMuB,iBAxEtB,MA2EjB,OAAO,WACHC,cAAcH,OAEnB,CAACvB,EAAQE,IAEZ,IAAMyB,EAAaC,uBAAY,SAACC,GAC5B,GAAe,MAAXA,EAAJ,CAEAA,EAAQC,UAAY,GACpB,IAAMC,EAASX,SAASY,cAAc,OACtCH,EAAQI,OAAOF,GACf,IAAMG,EAAI,IAAIC,IAAMJ,EAAQ,CAAEK,MAAO,OAAQC,QAAS,CAAEC,QAASnD,KACjE+C,EAAEK,UACFL,EAAEM,QAAQ,0BACVrC,EAAS+B,MACV,IAEH,OACI,qBAAKO,UAAY,YAAYC,IAAQf,I,oBC1E9BgB,MAhBf,WACE,OACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,KAAK,kBAAkBC,OAAK,EAAnC,SACE,cAAC,IAAD,CAAUC,GAAE,qBAAgBC,mBAE9B,cAAC,IAAD,CAAOH,KAAK,iBAAZ,SACE,cAACjD,EAAD,Y,MCZVqD,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEF9B,SAAS+B,eAAe,W","file":"static/js/main.fca7accf.chunk.js","sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\r\nimport Quill from \"quill\";\r\nimport \"quill/dist/quill.snow.css\";\r\nimport { io } from 'socket.io-client';\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nconst SAVE_INTERVAL_MS = 1500;\r\nconst TOOLBAR_OPTIONS = [\r\n  [{ header: [1, 2, 3, 4, 5, 6, false] }],\r\n  [{ font: [] }],\r\n  [{ list: \"ordered\" }, { list: \"bullet\" }],\r\n  [\"bold\", \"italic\", \"underline\"],\r\n  [{ color: [] }, { background: [] }],\r\n  [{ script: \"sub\" }, { script: \"super\" }],\r\n  [{ align: [] }],\r\n  [\"image\", \"blockquote\", \"code-block\"],\r\n  [\"clean\"],\r\n]\r\n\r\nexport default function TextEditor() {\r\n    const {id: documentId} = useParams();\r\n    const [socket, setSocket] = useState();\r\n    const [quill, setQuill] = useState();\r\n    console.log(documentId)\r\n\r\n    useEffect(() => {\r\n        const s = io(\"http://localhost:3001\", { transports: ['websocket', 'polling', 'flashsocket'] });\r\n        setSocket(s);\r\n\r\n        return () => {\r\n            s.disconnect();\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (socket == null || quill == null) return;\r\n\r\n        const handler = (delta, oldDelta, source) => {\r\n            if (source !== 'user') return;\r\n            socket.emit(\"send-changes\", delta);\r\n        };\r\n\r\n        quill.on('text-change', handler )\r\n\r\n        return () => {\r\n            quill.off('text-change', handler)\r\n        }\r\n    }, [socket, quill]);\r\n\r\n    useEffect(() => {\r\n        if (socket == null || quill == null) return;\r\n\r\n        const handler = (delta) => {\r\n            quill.updateContents(delta);\r\n        };\r\n\r\n        socket.on('receive-changes', handler )\r\n\r\n        return () => {\r\n            socket.off('receive-changes', handler)\r\n        }\r\n    }, [socket, quill]);\r\n\r\n    useEffect(() => {\r\n        if (socket == null || quill == null) return;\r\n    \r\n        socket.once(\"load-document\", document => {\r\n            quill.setContents(document);\r\n            quill.enable();\r\n        })\r\n\r\n        socket.emit('get-document', documentId);\r\n    }, [socket, quill, documentId])\r\n\r\n    useEffect(() => {\r\n        if (socket == null || quill == null) return;\r\n\r\n        const interval = setInterval(() => {\r\n            socket.emit('save-document', quill.getContents())\r\n        }, SAVE_INTERVAL_MS)\r\n\r\n        return () => {\r\n            clearInterval(interval);\r\n        }\r\n    }, [socket, quill])\r\n\r\n    const wrapperRef = useCallback((wrapper) => {\r\n        if (wrapper == null) return\r\n\r\n        wrapper.innerHTML = '';\r\n        const editor = document.createElement('div');\r\n        wrapper.append(editor);\r\n        const q = new Quill(editor, { theme: \"snow\", modules: { toolbar: TOOLBAR_OPTIONS} });\r\n        q.disable();\r\n        q.setText(\"Preparing the paper...\")\r\n        setQuill(q);\r\n    }, []);\r\n\r\n    return ( \r\n        <div className = \"container\" ref = { wrapperRef }></div>\r\n    )\r\n}","import TextEditor from \"./TextEditor\";\nimport {\n  BrowserRouter as Router,\n  Switch, \n  Route, \n  Redirect\n} from \"react-router-dom\";\nimport { v4 as uuidV4 } from \"uuid\";\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/word-processor\" exact>\n          <Redirect to={`/documents/${uuidV4()}`} />\n        </Route>\n        <Route path=\"/documents/:id\">\n          <TextEditor />\n        </Route>\n      </Switch>\n    </Router>\n    \n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport \"./styles.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}